(()=>{"use strict";var t,e={398:(t,e,s)=>{s(440);class i extends Phaser.Scene{constructor(){super({key:"BootScene"})}preload(){this.cameras.main.setBackgroundColor(0),this.createLoadingGraphics(),this.loadingText=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2-50,"Loading...",{fontSize:"20px",color:"#ffffff"}),this.loadingText.setOrigin(.5,.5),this.load.on("progress",(t=>{this.progressBar.clear(),this.progressBar.fillStyle(8971347,1),this.progressBar.fillRect(this.cameras.main.width/4,this.cameras.main.height/2-16,this.cameras.main.width/2*t,16)}),this),this.load.on("complete",(()=>{this.progressBar.destroy(),this.loadingBar.destroy(),this.loadingText.destroy()}),this),this.load.pack("preload","./assets/pack.json","preload")}update(){this.scene.start("MenuScene")}createLoadingGraphics(){this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(16777215,1),this.loadingBar.fillRect(this.cameras.main.width/4-2,this.cameras.main.height/2-18,this.cameras.main.width/2+4,20),this.progressBar=this.add.graphics()}}class h extends Phaser.GameObjects.Image{constructor(t){super(t.scene,t.x,t.y,t.texture),this.rotation=t.rotation,this.initImage(),this.scene.add.existing(this)}initImage(){this.bulletSpeed=1e3,this.setOrigin(.5,.5),this.setDepth(2),this.scene.physics.world.enable(this),this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.bulletSpeed,this.body.velocity)}update(){}}class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}constructor(){this.score=0,this.bestScore=parseInt(localStorage.getItem("BEST_SCORE"))||0}getScore(){return this.score}getBestScore(){return this.bestScore}resetScore(){this.score=0}increaseScore(t){this.score+=t}writeBestScore(){console.log(this.score,this.bestScore),this.score>this.bestScore&&(this.bestScore=this.score,localStorage.setItem("BEST_SCORE",this.bestScore.toString()))}}class a{static getInstance(t){return a.instance||(a.instance=new a(t)),a.instance}constructor(t){this.isMuted=!1,this.bgMusic=t.sound.add("bgMusic",{loop:!0,volume:.5}),this.shootMusic=t.sound.add("shootMusic"),this.hitMusic=t.sound.add("hitMusic")}getIsMuted(){return this.isMuted}playMusic(){this.bgMusic.play()}stopMusic(){this.bgMusic.stop()}playShoot(){this.shootMusic.play()}playHit(){this.hitMusic.play()}toggleSound(){this.isMuted=!this.isMuted,this.isMuted?this.bgMusic.pause():this.bgMusic.resume()}}class r extends Phaser.GameObjects.Image{getBullets(){return this.bullets}constructor(t){super(t.scene,t.x,t.y,t.texture,t.frame),this.isShooting=!1,this.initImage(),this.scene.add.existing(this)}initImage(){this.health=1,this.lastShoot=0,this.speed=350,this.setOrigin(.5,.5),this.setDepth(0),this.angle=-180,this.barrel=this.scene.add.image(this.x,this.y,"barrelBlue"),this.barrel.setOrigin(.5,1),this.barrel.setDepth(1),this.barrel.angle=180,this.lifeBar=this.scene.add.graphics(),this.redrawLifebar(),this.bullets=this.scene.add.group({active:!0,maxSize:10,runChildUpdate:!0}),this.cursors=this.scene.input.keyboard.createCursorKeys(),this.leftKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.rightKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.upKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.downKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.scene.input.on("pointermove",(t=>{this.barrel.rotation=Phaser.Math.Angle.Between(this.barrel.x,this.barrel.y,t.worldX,t.worldY)+Math.PI/2})),this.scene.input.on("pointerdown",this.handleDown,this),this.scene.input.on("pointerup",this.handleUp,this),this.scene.physics.world.enable(this)}update(){this.active?(this.barrel.x=this.x,this.barrel.y=this.y,this.lifeBar.x=this.x,this.lifeBar.y=this.y,this.handleInput(),this.handleShooting(),1400==n.getInstance().getScore()&&(this.scene.scene.launch("WinScene"),n.getInstance().writeBestScore(),this.active=!1)):(this.destroy(),this.barrel.destroy(),this.lifeBar.destroy())}handleDown(){this.isShooting=!0}handleUp(){this.isShooting=!1}handleInput(){this.upKey.isDown&&this.leftKey.isDown?(this.angle=-45,this.scene.physics.velocityFromAngle(-135,this.speed,this.body.velocity)):this.upKey.isDown&&this.rightKey.isDown?(this.angle=45,this.scene.physics.velocityFromAngle(-45,this.speed,this.body.velocity)):this.downKey.isDown&&this.leftKey.isDown?(this.angle=-135,this.scene.physics.velocityFromAngle(135,this.speed,this.body.velocity)):this.downKey.isDown&&this.rightKey.isDown?(this.angle=135,this.scene.physics.velocityFromAngle(45,this.speed,this.body.velocity)):this.upKey.isDown?(this.angle=0,this.scene.physics.velocityFromAngle(-90,this.speed,this.body.velocity)):this.downKey.isDown?(this.angle=180,this.scene.physics.velocityFromAngle(90,this.speed,this.body.velocity)):this.leftKey.isDown?(this.angle=-90,this.scene.physics.velocityFromAngle(180,this.speed,this.body.velocity)):this.rightKey.isDown?(this.angle=90,this.scene.physics.velocityFromAngle(0,this.speed,this.body.velocity)):this.body.setVelocity(0,0)}handleShooting(){this.isShooting&&this.scene.time.now>this.lastShoot&&(a.getInstance(this.scene).playShoot(),this.scene.cameras.main.shake(20,.005),this.scene.tweens.add({targets:this,props:{alpha:.8},delay:0,duration:5,ease:"Power1",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!0,paused:!1}),this.bullets.getLength()<10&&(this.bullets.add(new h({scene:this.scene,rotation:this.barrel.rotation,x:this.barrel.x,y:this.barrel.y,texture:"bulletBlue"})),this.lastShoot=this.scene.time.now+80))}redrawLifebar(){this.lifeBar.clear(),this.lifeBar.fillStyle(15100456,1),this.lifeBar.fillRect(-this.width/2,this.height/2,this.width*this.health,15),this.lifeBar.lineStyle(2,16777215),this.lifeBar.strokeRect(-this.width/2,this.height/2,this.width,15),this.lifeBar.setDepth(1)}updateHealth(){this.health>0?(this.health-=.05,this.redrawLifebar()):(this.health=0,this.active=!1,n.getInstance().writeBestScore(),this.scene.scene.launch("OverScene"))}}class o extends Phaser.GameObjects.Image{getBarrel(){return this.barrel}getBullets(){return this.bullets}constructor(t){super(t.scene,t.x,t.y,t.texture,t.frame),this.initContainer(),this.scene.add.existing(this)}initContainer(){this.health=1,this.lastShoot=0,this.speed=100,this.setDepth(0),this.barrel=this.scene.add.image(0,0,"barrelRed"),this.barrel.setOrigin(.5,1),this.barrel.setDepth(1),this.lifeBar=this.scene.add.graphics(),this.redrawLifebar(),this.bullets=this.scene.add.group({active:!0,maxSize:10,runChildUpdate:!0}),this.scene.tweens.add({targets:this,props:{y:this.y-200},delay:0,duration:2e3,ease:"Linear",easeParams:null,hold:0,repeat:-1,repeatDelay:0,yoyo:!0}),this.scene.physics.world.enable(this)}update(){this.active?(this.barrel.x=this.x,this.barrel.y=this.y,this.lifeBar.x=this.x,this.lifeBar.y=this.y,this.handleShooting()):(this.destroy(),this.barrel.destroy(),this.lifeBar.destroy(),n.getInstance().increaseScore(200))}handleShooting(){this.scene.time.now>this.lastShoot&&this.bullets.getLength()<10&&(this.bullets.add(new h({scene:this.scene,rotation:this.barrel.rotation,x:this.barrel.x,y:this.barrel.y,texture:"bulletRed"})),this.lastShoot=this.scene.time.now+400)}redrawLifebar(){this.lifeBar.clear(),this.lifeBar.fillStyle(15100456,1),this.lifeBar.fillRect(-this.width/2,this.height/2,this.width*this.health,15),this.lifeBar.lineStyle(2,16777215),this.lifeBar.strokeRect(-this.width/2,this.height/2,this.width,15),this.lifeBar.setDepth(1)}updateHealth(){this.health>0?(this.health-=.05,this.redrawLifebar()):(this.health=0,this.active=!1)}}class c extends Phaser.GameObjects.Image{constructor(t){super(t.scene,t.x,t.y,t.texture),this.initImage(),this.scene.add.existing(this)}initImage(){this.setOrigin(0,0),this.scene.physics.world.enable(this),this.body.setImmovable(!0)}update(){}}class l extends Phaser.Scene{constructor(){super({key:"GameScene"})}init(){}create(){n.getInstance().resetScore(),this.map=this.make.tilemap({key:"levelMap"}),this.tileset=this.map.addTilesetImage("tiles"),this.layer=this.map.createLayer("tileLayer",this.tileset,0,0),this.layer.setCollisionByProperty({collide:!0}),this.obstacles=this.add.group({runChildUpdate:!0}),this.enemies=this.add.group({}),this.convertObjects(),this.physics.add.collider(this.player,this.layer),this.physics.add.collider(this.player,this.obstacles),this.physics.add.collider(this.player.getBullets(),this.layer,(t=>this.bulletHitLayer(t)),void 0,this),this.physics.add.collider(this.player.getBullets(),this.obstacles,((t,e)=>this.bulletHitObstacles(t,e)),void 0,this),this.enemies.getChildren().forEach((t=>{this.physics.add.overlap(this.player.getBullets(),t,((t,e)=>this.playerBulletHitEnemy(t,e)),void 0,this),this.physics.add.overlap(t.getBullets(),this.player,((t,e)=>this.enemyBulletHitPlayer(t,e)),void 0),this.physics.add.collider(t.getBullets(),this.obstacles,((t,e)=>this.bulletHitObstacles(t,e)),void 0),this.physics.add.collider(t.getBullets(),this.layer,(t=>this.bulletHitLayer(t)),void 0)}),this),this.cameras.main.setBounds(0,0,this.map.widthInPixels,this.map.heightInPixels),this.cameras.main.startFollow(this.player,!0,.5,.5),this.cameras.main.setZoom(.6)}update(){this.player.update(),this.enemies.getChildren().forEach((t=>{if(t.update(),this.player.active&&t.active){var e=Phaser.Math.Angle.Between(t.body.x,t.body.y,this.player.body.x,this.player.body.y);t.getBarrel().angle=(e+Math.PI/2)*Phaser.Math.RAD_TO_DEG}}),this)}convertObjects(){this.map.getObjectLayer("objects").objects.forEach((t=>{if("player"===t.type)this.player=new r({scene:this,x:t.x,y:t.y,texture:"tankBlue"});else if("enemy"===t.type){let e=new o({scene:this,x:t.x,y:t.y,texture:"tankRed"});this.enemies.add(e)}else{let e=new c({scene:this,x:t.x,y:t.y-40,texture:t.type});this.obstacles.add(e)}}))}bulletHitLayer(t){t.destroy()}bulletHitObstacles(t,e){t.destroy()}enemyBulletHitPlayer(t,e){a.getInstance(this).playHit(),t.destroy(),e.updateHealth()}playerBulletHitEnemy(t,e){a.getInstance(this).playHit(),t.destroy(),e.updateHealth()}}class d extends Phaser.GameObjects.Container{constructor(t,e,s,i,h,n){super(t,e,s),this.setDepth(1/0),this.scene=t,this.callback=n,this.button=this.scene.add.image(0,0,i),this.add(this.button),this.bitmapText=this.scene.add.bitmapText(0,0,"font",h,24),Phaser.Display.Align.In.Center(this.bitmapText,this.button),this.add(this.bitmapText),this.setSize(this.button.width,this.button.height),this.scene.add.existing(this),this.button.setInteractive(),this.button.on("pointerdown",this.onDown,this),this.button.on("pointerup",this.onUp,this),this.button.on("pointerover",this.onOver,this),this.button.on("pointerout",this.onOut,this)}onDown(){this.button.setTint(10066329)}onUp(){this.button.clearTint(),this.callback()}onOver(){this.button.setTint(13421772)}onOut(){this.button.clearTint()}}class p extends Phaser.Scene{constructor(){super({key:"MenuScene"}),this.bitmapTexts=[]}init(){this.startKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.startKey.isDown=!1}create(){a.getInstance(this).playMusic(),this.background=this.add.image(0,0,"bg"),this.background.setOrigin(.5,.5),this.background.setPosition(this.cameras.main.width/2,this.cameras.main.height/2),this.startButton=new d(this,this.cameras.main.width/2,this.cameras.main.height/2,"btn","START",(()=>{this.popOutEffect(this.startButton,(()=>{this.scene.start("GameScene").start("HUDScene")}))}));const t=this.add.bitmapText(this.cameras.main.width/2,this.cameras.main.height/2-180,"font","TANK",80);t.setOrigin(.5,.5),this.bitmapTexts.push(t)}update(){}popOutEffect(t,e){this.tweens.add({targets:t,scale:1.2,duration:100,yoyo:!0,onComplete:()=>{e()}})}}class u extends Phaser.Scene{constructor(){super("OverScene")}create(){const{width:t,height:e}=this.cameras.main,s=this.add.graphics();s.fillStyle(0,.7),s.fillRect(0,0,t,e),this.container=this.add.image(0,0,"container"),this.container.setOrigin(.5),Phaser.Display.Align.In.Center(this.container,this.add.zone(t/2,e/2,t,e)),this.scoreText=this.add.bitmapText(t/2-100,e/2-100,"font","SCORE: ",24),this.numberText=this.add.text(t/2,e/2-100,n.getInstance().getScore().toString(),{fontSize:"24px",color:"#fff",fontStyle:"bold"}),this.highScoreText=this.add.bitmapText(t/2-100,e/2-50,"font","HIGH SCORE: ",24),this.highScoreNumberText=this.add.text(t/2+60,e/2-50,n.getInstance().getBestScore().toString(),{fontSize:"24px",color:"#fff",fontStyle:"bold"}),this.newGameBtn=new d(this,t/2,e/2+50,"btn","NEW GAME",(()=>{this.popOutEffect(this.newGameBtn,(()=>{this.scene.stop("HUDScene"),this.scene.stop("GameScene"),this.scene.start("GameScene"),this.scene.start("HUDScene"),this.scene.stop("PauseScene")}))})),this.mainMenuBtn=new d(this,t/2,e/2+150,"btn","MAIN MENU",(()=>{this.popOutEffect(this.mainMenuBtn,(()=>{this.scene.stop("HUDScene"),this.scene.stop("GameScene"),this.scene.stop("PauseScene"),this.scene.start("MenuScene")}))}))}popOutEffect(t,e){this.tweens.add({targets:t,scale:1.2,duration:50,yoyo:!0,onComplete:()=>{e()}})}}class y extends Phaser.GameObjects.Container{constructor(t,e,s,i,h,n){super(t,e,s),this.button=this.scene.add.image(0,0,i),this.add(this.button),this.callback=n,this.icon=this.scene.add.image(0,0,h),Phaser.Display.Align.In.Center(this.icon,this.button),this.add(this.icon),this.scene.add.existing(this),this.button.setInteractive(),this.button.on("pointerdown",this.onDown,this),this.button.on("pointerup",this.onUp,this),this.button.on("pointerover",this.onOver,this),this.button.on("pointerout",this.onOut,this)}onDown(){this.button.setTint(10066329)}onUp(){this.button.clearTint(),this.callback()}onOver(){this.button.setTint(13421772)}onOut(){this.button.clearTint()}getIcon(){return this.icon}}class g extends Phaser.Scene{constructor(){super("PauseScene")}create(){const{width:t,height:e}=this.cameras.main,s=this.add.graphics();s.fillStyle(0,.7),s.fillRect(0,0,t,e),this.container=this.add.image(0,0,"container"),this.container.setOrigin(.5),Phaser.Display.Align.In.Center(this.container,this.add.zone(t/2,e/2,t,e)),this.pauseText=this.add.text(t/2,e/2-50,"PAUSE",{fontSize:"48px",color:"#fff",fontStyle:"bold"}),this.pauseText.setOrigin(.5),this.resumeBtn=new y(this,t/2-50,e/2+50,"btnSquare","iconPlay",(()=>{this.popOutEffect(this.resumeBtn,(()=>{this.scene.wake("HUDScene"),this.scene.resume("GameScene"),this.scene.stop("PauseScene")}))})),this.replayBtn=new y(this,t/2+50,e/2+50,"btnSquare","iconReplay",(()=>{this.popOutEffect(this.replayBtn,(()=>{this.scene.stop("HUDScene"),this.scene.stop("GameScene"),this.scene.start("GameScene"),this.scene.start("HUDScene"),this.scene.stop("PauseScene")}))})),this.homeBtn=new y(this,t/2-50,e/2+150,"btnSquare","iconHome",(()=>{this.popOutEffect(this.homeBtn,(()=>{this.scene.stop("HUDScene"),this.scene.stop("GameScene"),this.scene.start("MenuScene"),this.scene.stop("PauseScene")}))})),this.soundBtn=new y(this,t/2+50,e/2+150,"btnSquare","iconSoundOn",(()=>{this.popOutEffect(this.soundBtn,(()=>{a.getInstance(this).toggleSound(),this.soundBtn.getIcon().setTexture(a.getInstance(this).getIsMuted()?"iconSoundOff":"iconSoundOn")}))}))}popOutEffect(t,e){this.tweens.add({targets:t,scale:1.2,duration:50,yoyo:!0,onComplete:()=>{e()}})}}class b extends Phaser.Scene{constructor(){super({key:"HUDScene"})}init(){}popOutEffect(t,e){this.tweens.add({targets:t,scale:1.2,duration:100,yoyo:!0,onComplete:()=>{e()}})}create(){this.scoreText=this.add.bitmapText(10,10,"font","SCORE: ",24),this.numberText=this.add.text(this.scoreText.width+10,10,n.getInstance().getScore().toString(),{fontSize:"24px",color:"#fff",fontStyle:"bold"}),this.highScoreText=this.add.bitmapText(10,40,"font","HIGH SCORE: ",24),this.highScoreNumberText=this.add.text(this.highScoreText.width+10,40,n.getInstance().getBestScore().toString(),{fontSize:"24px",color:"#fff",fontStyle:"bold"}),this.pauseButton=new d(this,0,0,"btnPause","",(()=>{this.popOutEffect(this.pauseButton,(()=>{this.scene.pause("GameScene"),this.scene.sleep("HUDScene"),this.scene.launch("PauseScene")}))})),Phaser.Display.Align.In.TopRight(this.pauseButton,this.add.zone(this.cameras.main.width-10,10,0,0))}update(){this.numberText.setText(n.getInstance().getScore().toString()),this.highScoreNumberText.setText(n.getInstance().getBestScore().toString())}}class m extends Phaser.Scene{constructor(){super("WinScene")}create(){const{width:t,height:e}=this.cameras.main,s=this.add.graphics();s.fillStyle(0,.7),s.fillRect(0,0,t,e),this.container=this.add.image(0,0,"container"),this.container.setOrigin(.5),Phaser.Display.Align.In.Center(this.container,this.add.zone(t/2,e/2,t,e)),this.winText=this.add.bitmapText(t/2,e/2-50,"font"," YOU WIN! ",40).setOrigin(.5),this.newGameBtn=new d(this,t/2,e/2+50,"btn","NEW GAME",(()=>{this.popOutEffect(this.newGameBtn,(()=>{this.scene.stop("HUDScene"),this.scene.stop("GameScene"),this.scene.start("GameScene"),this.scene.start("HUDScene"),this.scene.stop("PauseScene")}))})),this.mainMenuBtn=new d(this,t/2,e/2+150,"btn","MAIN MENU",(()=>{this.popOutEffect(this.mainMenuBtn,(()=>{this.scene.stop("HUDScene"),this.scene.stop("GameScene"),this.scene.stop("PauseScene"),this.scene.start("MenuScene")}))})),this.createConfetti()}createConfetti(){this.confetti=this.add.particles(0,window.innerHeight-300,"confetti",{frame:["1.png","2.png","3.png","4.png","5.png","6.png","7.png","8.png","9.png","10.png"],alpha:{min:.8,max:1},lifespan:3e3,rotate:{onEmit:()=>Phaser.Math.RND.between(0,360),onUpdate:(t,e,s,i)=>i+4*s},angle:{min:-60,max:-30},speed:{onEmit:t=>{let e=2*-t.angle-800;return Phaser.Math.RND.between(e-200,e+200)}},scale:{start:.3,end:0},accelerationX:{onEmit:()=>-1e3,onUpdate:t=>t.velocityX>=100?-1e3:0},accelerationY:{onEmit:()=>1200,onUpdate:t=>t.velocityY<=-100?1200:0},quantity:1,gravityY:600}).setDepth(100),this.confetti.explode(50)}popOutEffect(t,e){this.tweens.add({targets:t,scale:1.2,duration:50,yoyo:!0,onComplete:()=>{e()}})}}const S={title:"Tank",type:Phaser.AUTO,width:1200,height:768,parent:"game-container",backgroundColor:"#ffffff",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[i,p,l,u,g,b,m],input:{keyboard:!0},physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}}};class f extends Phaser.Game{constructor(t){super(t)}}window.addEventListener("load",(()=>{new f(S)}))}},s={};function i(t){var h=s[t];if(void 0!==h)return h.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,i),n.exports}i.m=e,t=[],i.O=(e,s,h,n)=>{if(!s){var a=1/0;for(l=0;l<t.length;l++){for(var[s,h,n]=t[l],r=!0,o=0;o<s.length;o++)(!1&n||a>=n)&&Object.keys(i.O).every((t=>i.O[t](s[o])))?s.splice(o--,1):(r=!1,n<a&&(a=n));if(r){t.splice(l--,1);var c=h();void 0!==c&&(e=c)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[s,h,n]},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={792:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var h,n,[a,r,o]=s,c=0;if(a.some((e=>0!==t[e]))){for(h in r)i.o(r,h)&&(i.m[h]=r[h]);if(o)var l=o(i)}for(e&&e(s);c<a.length;c++)n=a[c],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(l)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var h=i.O(void 0,[96],(()=>i(398)));h=i.O(h)})();